<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Leaflet Test</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>
    <style>
    body { margin:0; padding:0; }
    #mapid { position:absolute; top:0; bottom:0; width:100%; }
    </style>
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
            integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
            crossorigin=""></script>
    <script src="https://unpkg.com/shpjs@latest/dist/shp.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.0.3/chroma.min.js"></script>
    <script src="js/leaflet.shpfile.js"></script>
</head>
<body>
    <div id="mapid"></div>
    <script type="text/javascript">
        var mymap = L.map('mapid').setView([47.751307, 11.588271], 8);
        /*L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
            maxZoom: 18,
            id: 'mapbox.streets',
            accessToken: 'pk.eyJ1IjoicGh1aG5ndXllbiIsImEiOiJjanY1YWk4NXIyejU2NGNqd2x6MnRpYmlpIn0.n3xBZDj-jH1QeCWxq85H8g'
        }).addTo(mymap);*/
        /*L.tileLayer('http://{s}.tile.stamen.com/terrain-background/{z}/{x}/{y}.png', {
            attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
        }).addTo(mymap);*/
        L.tileLayer('http://localhost/hot/{z}/{x}/{y}.png', {
            maxZoom: 18
        }).addTo(mymap);

        var maxData = Number.MIN_VALUE, minData = Number.MAX_VALUE;
        layer = L.shapefile("../data/seis_cells", {
            onEachFeature: function(feature, layer) {
                var d = feature.properties.Data;
                if (d > maxData) maxData = d;
                if (d < minData) minData = d;
            }
        });
        layer.once("data:loaded", function() {
            var f = chroma.scale(['0000ff', '00ffff', '00ff00', 'ffff00', 'ff0000']).domain([minData, maxData]);
            layer.setStyle(function(feature) {
                var d = feature.properties.Data;
                return {
                    stroke: false,
                    fill: true,
                    fillColor: f(d),
                    fillOpacity: (d-minData)/(maxData-minData)
                };
            });
        });
        layer.addTo(mymap);
    </script>
</body>
</html>
